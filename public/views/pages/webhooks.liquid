---
slug: shippo/webhooks
method: post
layout_name: ''
authorization_policies:
---
{% parse_json 'webhook_data' %}{{ context.post_params }}{% endparse_json %}

{% if webhook_data.event == 'transaction_updated' %}
  {% assign transaction = webhook_data.data %}
  {% log context.post_params, type: "Webhook transaction" %}
  {% graphql g_transactions = "modules/shippo/get_transaction", object_id: transaction.object_id %}
  {% assign existing_transaction = g_transactions.customizations.results.first %}
  {% if existing_trnsaction.id != blank %}
    {% graphql "modules/shippo/update_transaction_tracking_status" %}
    {% parse_json data %}
      { "rate_id": "{{ existing_transaction.object_id }}" }
    {% endparse_json %}
    {% graphql g = 'modules/shippo/shippo_request', template: 'modules/shippo/get_transaction', data: data %}
  {% endif %}
{% endif %}


